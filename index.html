<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="计算巢是阿里云开放给企业应用服务商的服务管理平台。服务商能够在计算巢上发布私有化部署服务，为其客户提供云上软件一键部署的能力；同时也支持全托管模式的服务，赋能服务商托管其客户资源。">
  <title>服务使用说明 - Aliyun 计算巢 x Demo</title>

  <link rel="shortcut icon" href="img/favicon.ico">

  <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
  <link rel="stylesheet" href="css/theme.css">
  

  

  
  

  
    <script src="search/main.js"></script>
  

  

  <script src="js/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>

<body>
  <div class="container">
    <div class="nav">
      <div class="nav-inner">
        <div class="logo">
          <img src="./img/logo-2x.png">
        </div>
        <div class="nav-list">
          <ul>
          
              <li><a href="#_1">服务使用说明</a></li>
              
                  <li><a href="#_2">产品说明</a></li>
                  
              
                  <li><a href="#mytopling">MyTopling 数据库的优势</a></li>
                  
              
                  <li><a href="#mytopling_1">MyTopling 数据库实例创建流程</a></li>
                  
                      <li class="li-h3"><a href="#1">1.创建数据库依赖项</a></li>
                  
                      <li class="li-h3"><a href="#2-mytopling">2. 创建 MyTopling 数据库实例(点击跳转)</a></li>
                  
                      <li class="li-h3"><a href="#3">3. 管理与连接数据库</a></li>
                  
              
                  <li><a href="#_4">按量付费说明</a></li>
                  
              
                  <li><a href="#_5">常见问题</a></li>
                  
              
          
          </ul>
        </div>
      </div>
    </div>
    <div class="content theme-github">
      
      <div class="content-inner">        
        
        <h1 id="_1">服务使用说明</h1>
<h2 id="_2">产品说明</h2>
<p>ToplingDB SaaS 系列数据库(如 MyTopling)由以下三部分组成:
* <a href="https://market.aliyun.com/products/56024006/cmgj00064106.html">Topling SaaS 弹性计算服务</a> 执行代理运算。在数据库运行的过程中，Topling SaaS 弹性计算服务会按照使用运算量收取费用。</p>
<ul>
<li>
<p><a href="https://computenest.console.aliyun.com/service/instance/create/cn-hangzhou?type=user&amp;ServiceId=service-cb1b7a70ed544bbcaa75">Topling 数据库运行环境</a>
为后续创建 MyTopling 等数据库创建运行环境。包含VPC、vSwitch以及连接到 Topling SaaS 弹性计算服务的对等连接。ToplingDB 系列数据库必须部署在对应地域(Region)的运行环境下。</p>
</li>
<li>
<p><a href="https://computenest.console.aliyun.com/service/instance/create/cn-hangzhou?type=user&amp;ServiceId=service-7e82cdf7c86f4d2f906e">MyTopling 数据库</a>
用户实际使用的数据库。除了数据库本身使用的ECS资源会由阿里云代扣之外，我方会收取数据库调用 <code>Topling SaaS 弹性计算服务</code>的费用（数据库自动调用，无需用户干涉），按照服务消耗的计算量收费。</p>
</li>
</ul>
<p>弹性计算服务收费相关详见后文<strong>按量付费说明</strong></p>
<h2 id="mytopling">MyTopling 数据库的优势</h2>
<p><strong>ECS 8c32g 本地 SSD(ecs.i3g.2xlarge)</strong>
<img alt="" src="img/mytopling-bench.png" /></p>
<h2 id="mytopling_1">MyTopling 数据库实例创建流程</h2>
<h3 id="1">1.创建数据库依赖项</h3>
<h4 id="11-topling-saas">1.1 开通 <a href="https://market.aliyun.com/products/56024006/cmgj00064106.html">Topling SaaS 弹性计算服务(点击跳转)</a></h4>
<p><img src="img/api-image.png" height="200"/>
本服务是后续资源创建的基础，如果未开通，则无法继续。（本服务为 Topling 的所有数据库提供服务，MyTopling 是其中之一）</p>
<h4 id="12-topling">1.2 创建 <a href="https://computenest.console.aliyun.com/service/instance/create/cn-hangzhou?type=user&amp;ServiceId=service-cb1b7a70ed544bbcaa75">Topling 数据库部署环境(点击跳转)</a></h4>
<p><img src="img/topling-db-env.png" height="300"/></p>
<p>为数据库实例准备 VPC，每个地域必须创建一次且仅能创建一次。（本运行环境为 Topling 的所有数据库提供支撑，MyTopling 是其中之一）</p>
<p><strong>注意</strong>：如果您未开通 <a href="https://market.aliyun.com/products/56024006/cmgj00064106.html">Topling SaaS 弹性计算服务</a> 则 <a href="https://computenest.console.aliyun.com/service/instance/create/cn-hangzhou?type=user&amp;ServiceId=service-cb1b7a70ed544bbcaa75">Topling 数据库运行环境</a>
会创建失败。请删除后重建</p>
<p><strong>注意</strong>：如果您尚未开通 CDT，会出现以下提示信息，按照提示开通 CDT，然后继续下一步。</p>
<p><img alt="" src="img/requires-ctd.png" /></p>
<h3 id="2-mytopling">2. 创建 <a href="https://computenest.console.aliyun.com/service/instance/create/cn-hangzhou?type=user&amp;ServiceId=service-7e82cdf7c86f4d2f906e">MyTopling 数据库实例(点击跳转)</a></h3>
<p>MyTopling 实例为用户实际使用的数据库。如下图，用户按自身需求填写选项内容，填写完成后即可创建数据库。</p>
<p><img alt="" src="img/mytopling-img.png" /></p>
<blockquote>
<p><strong>注意</strong>：<code>临时测试(不可用于生产系统)</code> 使用抢占式 ECS 实例，价格低廉，但有可能会被云厂商回收，导致数据消失，因此仅供临时测试使用，绝不可用于生产系统。此种实例产生的按量付费的 SaaS 费用不变，与其它类型的相同。</p>
</blockquote>
<p>用户可以使用<a href="https://dms.aliyun.com/">阿里云DMS</a> 管理创建的数据库（如图），DMS 连接数据库的初始用户名为 <code>mytopling_dms</code>，密码为<code>MyToplingDmsPw</code>。
<img alt="" src="img/dms.png" /></p>
<blockquote>
<p><strong>注意</strong>：DMS 用户 (mytopling_dms) 仅供 DMS 服务连接，在不修改数据库白名单的前提下，除阿里云官方服务外，其他客户端无法使用此用户名连接数据库。</p>
</blockquote>
<h3 id="3">3. 管理与连接数据库</h3>
<h4 id="_3">查看数据库实例</h4>
<p>创建 MyTopling 后，可前往<a href="https://computenest.console.aliyun.com/service/instance/cn-hangzhou">计算巣控制台</a>查看创建的实例。如图
<img alt="" src="img/compute-nest.png" /></p>
<p>点击 MyTopling 数据库实例查看创建的数据库，如图:</p>
<p><img alt="" src="img/instance.png" /></p>
<p>说明：</p>
<ul>
<li>使用私网地址连接数据库,如图中的 10.171.4.55, 公网地址默认无法连接</li>
<li>通过相关超链接可以访问实例的引擎监控和 grafana 监控</li>
</ul>
<p>MyTopling 默认创建的安全组没有放行 3306 端口，但同安全组内可以访问任意端口。</p>
<p>因此，用户可以在 MyTopling 相同安全组内创建实例以连接数据库，或自行放行 10.0.0.0/8 等网段的 3306 端口。</p>
<p>注意，切勿放行 MyTopling 3306 端口到 0.0.0.0/0 。</p>
<p>如果现有的其他 VPC 需要连接 MyTopling 数据库，可以使用<a href="https://cen.console.aliyun.com/cen/list">云企业网</a> 或 <a href="https://vpc.console.aliyun.com/vpcpeer">对等连接</a> 打通网段.</p>
<p>操作方法参见阿里云的<a href="https://help.aliyun.com/zh/vpc/user-guide/cross-vpc-interconnection-overview">相关文档</a>。</p>
<h2 id="_4">按量付费说明</h2>
<p><img alt="" src="img/fee-formula-and-table.png" /></p>
<ul>
<li>每超出前一个价格区间，就开始按下一个价格区间计价，例如，100G 以内为 ￥0.5/G，100G \~ 1T 区间的 900G 价格为 ￥0.25/G。</li>
<li>用预付费流量包抵扣时，从一开始就按流量包的价格计算，例如购买了 100T 的流量包，从一开始就按 ￥0.05/G 的价格计算。</li>
</ul>
<p><code>注: 阿里云后付费目前尚未推出流量包功能，可联系客服享受相同折扣</code></p>
<p>以 ToplingDB 的写放大估计，<em>NormSize</em> 一般为写入数据量的 5~10 倍，不同的数据 Pattern，写放大会有所不同，以实际为准。
举例来说: 同时运行 sysbench 和 tpcc，对数据库发出约 6 MiB/s 持续的随机写，每小时产生的 <em>NormSize</em> 约为 170 G，以原价计为 ￥85（貌似挺贵）。
保持 6 MiB/s 的速度持续运行一年，产生 1489T 的 <em>NormSize</em>，使用按量付费价格为 ￥42,790，使用 10P 的预付费流量包，价格为￥18,613。
对于普通应用，写压力远低于此，实际支出是非常低的。同时 MyTopling 带来的 3 倍以上 CPU、内存、SSD 节约，更加实实在在地降低了成本。</p>
<p>实际上，一方面现实应用很少有这么高的写压力，另一方面 MyTopling 能承载的极限压力远高于此！此外，MyTopling 也有完全的私有化部署版本，SaaS 也运行在用户的 ECS 上，按传统方式收费，进一步为高负载应用降低成本。</p>
<h2 id="_5">常见问题</h2>
<ul>
<li>实例创建失败</li>
<li>弹性计算服务被关闭<ul>
<li>如果您开通 <code>Topling SaaS 弹性计算服务</code> 后关闭了服务，将无法继续创建 ToplingDB 相关实例</li>
</ul>
</li>
<li>未开通 DMS 服务<ul>
<li>如果实例创建完成，但此用户尚未使用过阿里云的 DMS 服务，则可能会导致创建失败。然而此时实例数据库已创建成功，不影响 DMS 管理数据库之外的功能。</li>
<li>注意，此时虽然计算巢资源栈创建失败，但 ECS 实例已经创建完成，因此阿里云会收取实例费用。</li>
</ul>
</li>
<li>忘记用户名密码</li>
<li>可以前往 DMS 控制台，使用用户名 <code>mytopling_dms</code> 密码 <code>MyToplingDmsPw</code> 连接数据库重置。</li>
<li><strong>注意</strong>，不要修改自动创建的用户，如 <code>sync</code>，<code>mytopling_dms</code> 等用户。</li>
<li>资源栈删除失败</li>
<li>数据库资源栈删除失败
  查看对应安全组(名字以 ros_VpcSecurityGroup_stack 开头)下是否存在其他ECS等资源，如果存在，移出此安全组后重新删除资源栈</li>
<li>Topling 数据库运行环境删除失败
    查看 VPC 下是否有未释放的实例以及未删除的 ECS、NAS 挂载点等资源</li>
</ul>
        
      </div>

      <div class="copyrights">© 2009-2022 Aliyun.com 版权所有</div>
    </div>
  </div>
  
  <!--
  MkDocs version      : 1.5.3
  Docs Build Date UTC : 2023-11-21 11:12:52.915655+00:00
  -->
</body>
</html>